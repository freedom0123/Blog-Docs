---
title: 日志相关
description: 补充日志相关内容学习
sticky: 1
recommend: 1
tag:
 - 工作积累
---

## 一、日志切面

定义好一个界面类，方便以后新开项目直接拿过来

```java
package com.channelsoft.ccms.common.log;

import com.alibaba.fastjson.JSON;
import lombok.extern.slf4j.Slf4j;
import org.aspectj.lang.ProceedingJoinPoint;
import org.aspectj.lang.annotation.Around;
import org.aspectj.lang.annotation.Aspect;
import org.aspectj.lang.annotation.Pointcut;
import org.aspectj.lang.reflect.MethodSignature;
import org.springframework.stereotype.Component;

import java.lang.reflect.Method;
import java.text.SimpleDateFormat;
import java.util.Date;
/**
 * 请求日志切面类
 * @project: ccms-adapter
 * @description: 参考链接：http://ones.ccod.io/wiki/#/team/5NcNvTK1/space/3Rh6PY8L/page/FG2skmhY
 * @data: 2023/7/22 19:30
 */
@Slf4j
@Aspect
@Component
public class LogAspectj {
    private final static SimpleDateFormat matter = new SimpleDateFormat("yyyy年MM月dd日E HH时mm分ss秒");
    private Date date = null;
    // 针对日志注解切面
    @Pointcut("execution(* com.channelsoft.ccms.controller.*.*(..))")
    private void printTimeAndArgs() {}

    @Around("printTimeAndArgs()")
    public Object aroundMethod(ProceedingJoinPoint point) throws Throwable {
        Object result = null;
        // 获取切入的 Method和注解实例
        MethodSignature joinPointObject = (MethodSignature) point.getSignature();
        // 获取参数，类名，方法名
        Method method = joinPointObject.getMethod();
        Object[] args = point.getArgs();
        Class declaringType = joinPointObject.getDeclaringType();
        String methodName = method.getName();
        // 注解实例中参数为打印日志
        try {
            date = new Date();
            // 运行 函数并打印日志
            if (log.isInfoEnabled()) {
                log.info("【类和方法名为：】{},【入参：】{},【开始时间：】{}", declaringType.getName()+"#"+methodName, 0 == args.length ? "void" : JSON.toJSONString(args),matter.format(date));
            }
            result = point.proceed();
            if (log.isInfoEnabled()) {
                log.info("【类和方法名为：】{},【出参：】{},【运行时长：】{}", declaringType.getName()+"#"+methodName,null == result ? "void" : JSON.toJSONString(result),System.currentTimeMillis() - date.getTime());
            }
        } catch (Throwable throwable) {
            log.error("【类和方法名为：】:{},【入参：】：{},发生系统异常，【异常信息为：】", methodName, 0 == args.length ? "void" : JSON.toJSONString(args), throwable);
            throw throwable;
        }
        return result;
    }
}
```

